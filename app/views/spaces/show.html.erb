<p style="color: green"><%= notice %></p>
<div class="container">
  <%= link_to "<< Retour aux espaces", root_path %>

  <div class="d-flex justify-content-between align-self-center mt-3">
    <div class="adress-show">
      <h1>
        <strong><%= @space.city %></strong> • 5 ⭐
      </h1>
      <p>
        <%= @space.address %>
      </p>
    </div>
    <div class="button">
      <%= link_to "Modifier", edit_space_path(@space), class:"btn btn-outline-secondary" %>
      <%= link_to "Effacer", space_path(@space), class: "btn btn-outline-danger", remote: true, data: { turbo_confirm: "Êtes vous sur ?", turbo_method: :delete } %>
    </div>
  </div>


  <div class="d-flex flex-row">
    <div class="col-12 col-lg-8 me-5">
      <%= render @space %>
      <div class="mt-4">
        <h3>Métier recherché : <%= @space.space_profession %></h3>
        <p><%= @space.description %></p>
      </div>

      <div style="width: 100%; height: 300px;"
        data-controller="map"
        data-map-marker-value="<%= @marker.to_json %>"
        data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>

      <% @space.space_ratings.each do |sr| %>
      <div class="card mt-3" style="width: 18rem;">
        <div class="card-body">
          <h5 class="card-title"><%= sr.rating %> ⭐</h5>
          <p class="card-text"><%= sr.comment %></p>
        </div>
      </div>
      <% end %>
    </div>


    <div class="container">
      <div class="booking-wrapper text-secondary">
        <h3>Sélectionner vos dates</h3>
        <%= simple_form_for [@space, @booking] do |f| %>
        <%= f.error_notification %>
        <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>
        <%= f.simple_fields_for :booking_dates do |booking_date_form| %>
        <%= booking_date_form.input :selected_day, as: :string,
                                            required: false,
                                            label: "Dates de réservation",
                                            input_html: { class: "datepicker", data: { controller: "datepicker" }, style: "display: none;" } %>
        <% end %>
        <%= f.button :submit, "Ajouter à votre réservation", class: "btn btn-primary" %>
        <% end %>
      </div>
      <div class="booking-wrapper text-secondary mt-3">
      <div class="detail-resa">
        <h3><strong> Votre réservation </strong></h3>
      </div>
      <div class="detail-resa mt-3">
        <% @space.booking_dates.each do |booking| %>
          <p>Le <%= booking.selected_day.strftime("%d" + "/" + "%m" + "/" + "%Y") %></p>
        <% end %>
      </div>
      <div class="detail-resa mt-3" data-date-target="price">
        <p> <%=  %> Nbre de jours * <%= @space.price_per_day %>€HT </p>
        <p> <%=  %> Nbre de semaines * <%= @space.price_per_week %>€HT </p>
        <p> <%=  %> Nbre de mois * <%= @space.price_per_month %>€HT </p>
      </div>
      <div class="detail-resa">
        <h3> Détails prix </h3>
        <p> Total location <%= @space.price_per_day %>€HT </p>
        <p> Frais de service : X€HT </p>
        <p> Taxes : X€HT </p>
      </div>
      <div class="detail-resa mt-3">
        <p><strong> TOTAL <%= @space.price_per_day %>€HT </strong></p>
      </div class="mt-3">
      <!-- Créer le bookin et renvoyer vers la page "Mes réservations"du dashboard -->
        <%= link_to "Réserver", space_bookings_path(@space), class:"btn btn-primary mt-3" %>
      </div>
    </div>
  </div>


    <div id="contact">
      <h3> Laisser un commentaire </h3>
      <%= simple_form_for [@space, @space_rating] do |f| %>
        <%= f.error_notification %>
        <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>

        <div class="form-inputs">
          <%= f.input :comment %>
          <%= f.input :rating %>
        </div>

        <div class="form-actions">
          <%= f.button :submit %>
        </div>
      <% end %>
    </div>
  </div>
</div>
